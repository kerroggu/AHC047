








<!DOCTYPE html>
<html>
<head>
	<title>A - Lovely Language Model</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Language" content="ja">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<meta name="google-site-verification" content="nXGC_JxO0yoP1qBzMnYD_xgufO6leSLw1kyNo2HZltM" />

	
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-RC512FD18N"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('set', 'user_properties', {
			
				'login_status': 'logged_in',
			
		});
		gtag('config', 'G-RC512FD18N');
	</script>

	
	<meta name="description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。">
	<meta name="author" content="AtCoder Inc.">

	<meta property="og:site_name" content="AtCoder">
	
	<meta property="og:title" content="A - Lovely Language Model" />
	<meta property="og:description" content="プログラミング初級者から上級者まで楽しめる、競技プログラミングコンテストサイト「AtCoder」。オンラインで毎週開催プログラミングコンテストを開催しています。競技プログラミングを用いて、客観的に自分のスキルを計ることのできるサービスです。" />
	<meta property="og:type" content="website" />
	<meta property="og:url" content="https://atcoder.jp/contests/ahc047/tasks/ahc047_a" />
	<meta property="og:image" content="https://img.atcoder.jp/assets/atcoder.png" />
	<meta name="twitter:card" content="summary" />
	<meta name="twitter:site" content="@atcoder" />
	
	<meta property="twitter:title" content="A - Lovely Language Model" />

	<link href="//fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet" type="text/css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/d49c595/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="//img.atcoder.jp/public/d49c595/css/base.css">
	<link rel="shortcut icon" type="image/png" href="//img.atcoder.jp/assets/favicon.png">
	<link rel="apple-touch-icon" href="//img.atcoder.jp/assets/atcoder.png">
	<script src="//img.atcoder.jp/public/d49c595/js/lib/jquery-1.9.1.min.js"></script>
	<script src="//img.atcoder.jp/public/d49c595/js/lib/bootstrap.min.js"></script>
	<script src="//img.atcoder.jp/public/d49c595/js/cdn/js.cookie.min.js"></script>
	<script src="//img.atcoder.jp/public/d49c595/js/cdn/moment.min.js"></script>
	<script src="//img.atcoder.jp/public/d49c595/js/cdn/moment_js-ja.js"></script>
	<script>
		var LANG = "ja";
		var userScreenName = "keroru";
		var csrfToken = "UJ3O+CKvGxMvJezEGZGXD22Xe6c7pPUFuOPjMKcTrVs="
	</script>
	<script src="//img.atcoder.jp/public/d49c595/js/utils.js"></script>
	
	
		<script src="//img.atcoder.jp/public/d49c595/js/contest.js"></script>
		<link href="//img.atcoder.jp/public/d49c595/css/contest.css" rel="stylesheet" />
		<script>
			var contestScreenName = "ahc047";
			var remainingText = "残り時間";
			var countDownText = "開始まであと";
			var startTime = moment("2025-05-18T19:00:00+09:00");
			var endTime = moment("2025-05-18T23:00:00+09:00");
		</script>
		<style>.accordion-title {
background: #F5F5F5;
cursor: pointer;
font-size: 16px;
padding: 20px 40px;
position: relative;
}

.accordion-title:after {
position: absolute;
display: block;
content: '';
top: 35%;
right: 22px;
width: 8px;
height: 8px;
border-top: 2px solid #000;
border-right: 2px solid #000;
transform: rotate(135deg);
transition: all .3s ease-in-out;
}

.accordion-title.open:after {
transform: rotate(-45deg);
top: 45%;
}

.accordion-text {
border-left: 1px solid #DDD;
border-right: 1px solid #DDD;
border-bottom: 1px solid #DDD;
display: none;
padding: 20px 40px;
}</style>
	
	
		<link href="//img.atcoder.jp/public/d49c595/css/cdn/select2.min.css" rel="stylesheet" />
		<link href="//img.atcoder.jp/public/d49c595/css/cdn/select2-bootstrap.min.css" rel="stylesheet" />
		<script src="//img.atcoder.jp/public/d49c595/js/lib/select2.min.js"></script>
	
	
		<script src="//img.atcoder.jp/public/d49c595/js/ace/ace.js"></script>
		<script src="//img.atcoder.jp/public/d49c595/js/ace/ext-language_tools.js"></script>
	
	
		<script src="//img.atcoder.jp/public/d49c595/js/cdn/run_prettify.js"></script>
	
	
		<link rel="stylesheet" href="//img.atcoder.jp/public/d49c595/css/cdn/katex.min.css">
		<script defer src="//img.atcoder.jp/public/d49c595/js/cdn/katex.min.js"></script>
		<script defer src="//img.atcoder.jp/public/d49c595/js/cdn/auto-render.min.js"></script>
		<script>$(function(){$('var').each(function(){var html=$(this).html().replace(/<sub>/g,'_{').replace(/<\/sub>/g,'}');$(this).html('\\('+html+'\\)');});});</script>
		<script>
			var katexOptions = {
				delimiters: [
					{left: "$$", right: "$$", display: true},
					
					{left: "\\(", right: "\\)", display: false},
					{left: "\\[", right: "\\]", display: true}
				],
      	ignoredTags: ["script", "noscript", "style", "textarea", "code", "option"],
				ignoredClasses: ["prettyprint", "source-code-for-copy"],
				throwOnError: false
			};
			document.addEventListener("DOMContentLoaded", function() { renderMathInElement(document.body, katexOptions);});
		</script>
	
	
	
	
	
	
	
	
	
	<script src="//img.atcoder.jp/public/d49c595/js/base.js"></script>
</head>

<body>

<script type="text/javascript">
	var __pParams = __pParams || [];
	__pParams.push({client_id: '468', c_1: 'atcodercontest', c_2: 'ClientSite'});
</script>
<script type="text/javascript" src="https://cdn.d2-apps.net/js/tr.js" async></script>


<div id="modal-contest-start" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト開始</h4>
			</div>
			<div class="modal-body">
				<p>トヨタ自動車プログラミングコンテスト2025#2（AtCoder Heuristic Contest 047）が開始されました。</p>
			</div>
			<div class="modal-footer">
				
					<a class="btn btn-primary" href='/contests/ahc047/tasks'>問題一覧ページへ移動</a>
				
			</div>
		</div>
	</div>
</div>
<div id="modal-contest-end" class="modal fade" tabindex="-1" role="dialog">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				<h4 class="modal-title">コンテスト終了</h4>
			</div>
			<div class="modal-body">
				<p>トヨタ自動車プログラミングコンテスト2025#2（AtCoder Heuristic Contest 047）は終了しました。</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">閉じる</button>
			</div>
		</div>
	</div>
</div>
<div id="main-div" class="float-container">


	<nav class="navbar navbar-inverse navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
					<span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span>
				</button>
				<a class="navbar-brand" href="/home"></a>
			</div>
			<div class="collapse navbar-collapse" id="navbar-collapse">
				<ul class="nav navbar-nav">
				
					<li><a class="contest-title" href="/contests/ahc047">トヨタ自動車プログラミングコンテスト2025#2（AtCoder Heuristic Contest 047）</a></li>
				
				</ul>
				<ul class="nav navbar-nav navbar-right">
					
					<li class="dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
							<img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語 <span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li><a href="/contests/ahc047/tasks/ahc047_a?lang=ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'> 日本語</a></li>
							<li><a href="/contests/ahc047/tasks/ahc047_a?lang=en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'> English</a></li>
						</ul>
					</li>
					
					
						<li class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> keroru (Contestant) <span class="caret"></span>
							</a>
							<ul class="dropdown-menu">
								<li><a href="/users/keroru"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> マイプロフィール</a></li>
								<li class="divider"></li>
								<li><a href="/settings"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> 基本設定</a></li>
								<li><a href="/settings/icon"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span> アイコン設定</a></li>
								<li><a href="/settings/password"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> パスワードの変更</a></li>
								<li><a href="/settings/fav"><span class="glyphicon glyphicon-star" aria-hidden="true"></span> お気に入り管理</a></li>
								
								
								
								<li class="divider"></li>
								<li><a href="javascript:void(form_logout.submit())"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span> ログアウト</a></li>
							</ul>
						</li>
					
				</ul>
			</div>
		</div>
	</nav>

	<form method="POST" name="form_logout" action="/logout?continue=https%3A%2F%2Fatcoder.jp%2Fcontests%2Fahc047%2Ftasks%2Fahc047_a">
		<input type="hidden" name="csrf_token" value="UJ3O&#43;CKvGxMvJezEGZGXD22Xe6c7pPUFuOPjMKcTrVs=" />
	</form>
	<div id="main-container" class="container"
		 	style="padding-top:50px;">
		


<div class="row">
	<div id="contest-nav-tabs" class="col-sm-12 mb-2 cnvtb-fixed">
	<div>
		<small class="contest-duration">
			
				コンテスト時間:
				<a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20250518T1900&p1=248' target='blank'><time class='fixtime fixtime-full'>2025-05-18 19:00:00+0900</time></a> ~ <a href='http://www.timeanddate.com/worldclock/fixedtime.html?iso=20250518T2300&p1=248' target='blank'><time class='fixtime fixtime-full'>2025-05-18 23:00:00+0900</time></a> 
				(240分)
			
		</small>
		<small class="back-to-home pull-right"><a href="/home">AtCoderホームへ戻る</a></small>
	</div>
	<ul class="nav nav-tabs">
		<li><a href="/contests/ahc047"><span class="glyphicon glyphicon-home" aria-hidden="true"></span> トップ</a></li>
		
			<li class="active"><a href="/contests/ahc047/tasks"><span class="glyphicon glyphicon-tasks" aria-hidden="true"></span> 問題</a></li>
		

		
			<li><a href="/contests/ahc047/clarifications"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> 質問 <span id="clar-badge" class="badge" ></span></a></li>
		

		
			<li><a href="/contests/ahc047/submit?taskScreenName=ahc047_a"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> 提出</a></li>
		

		
			<li>
				<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> 提出結果<span class="caret"></span></a>
				<ul class="dropdown-menu">
					
					
						<li><a href="/contests/ahc047/submissions/me"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> 自分の提出</a></li>
						
						
					
				</ul>
			</li>
		

		
			
				
					<li><a href="/contests/ahc047/standings"><span class="glyphicon glyphicon-sort-by-attributes-alt" aria-hidden="true"></span> 順位表</a></li>
				
			
		

		
			<li><a href="/contests/ahc047/custom_test"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> コードテスト</a></li>
		

		
		

		<li class="pull-right"><a id="fix-cnvtb" href="javascript:void(0)"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></a></li>
	</ul>
</div>
	<div class="col-sm-12">
		<span class="h2">
			A - Lovely Language Model
			
		</span>
		<span id="task-lang-btn" class="pull-right"><span data-lang="ja"><img src='//img.atcoder.jp/assets/top/img/flag-lang/ja.png'></span> / <span data-lang="en"><img src='//img.atcoder.jp/assets/top/img/flag-lang/en.png'></span></span>
		<script>
			$(function() {
				var ts = $('#task-statement span.lang');
				if (ts.children('span').size() <= 1) {
					$('#task-lang-btn').hide();
					ts.children('span').show();
					return;
				}
				var REMEMBER_LB = 5;
				var LS_KEY = 'task_lang';
				var taskLang = getLS(LS_KEY) || '';
				var changeTimes = 0;
				if (taskLang == 'ja' || taskLang == 'en') {
					changeTimes = REMEMBER_LB;
				} else {
					var changeTimes = parseInt(taskLang, 10);
					if (isNaN(changeTimes)) {
						changeTimes = 0;
						delLS(LS_KEY);
					}
					changeTimes++;
					taskLang = LANG;
				}
				ts.children('span.lang-' + taskLang).show();

				$('#task-lang-btn span').click(function() {
					var l = $(this).data('lang');
					ts.children('span').hide();
					ts.children('span.lang-' + l).show();
					if (changeTimes < REMEMBER_LB) setLS(LS_KEY, changeTimes);
					else setLS(LS_KEY, l);
				});
			});
		</script>
		<hr/>
		<p>
			実行時間制限: 2 sec / メモリ制限: 1024 MB
			
			
		</p>

		<div id="task-statement">
			


	
	

			<span class="lang">
<span class="lang-ja">

<div class="part">
<section>
<h3>問題文</h3><p>高橋君には、好きな文字列が <var>N</var> 個ある。<var>i</var> 番目の文字列は <var>S_i</var> であり、その好ましさは <var>P_i</var> である。各 <var>S_i</var> は、<code>a</code>〜<code>f</code> の6種類の英小文字のみから構成されている。</p>
<p>最近、高橋君は確率的に文字列を生成するモデルに興味を持っており、自分が好きな文字列が高い確率で現れるような生成モデル、<strong>Lovely Language Model (LLM)</strong> を設計したいと考えている。</p>
<p>この生成モデルは <var>M</var> 個の状態から構成される。各状態 <var>i</var>（<var>0 \leq i &lt; M</var>）には <code>a</code>〜<code>f</code> の 1 文字の英小文字 <var>C_i</var> を割り当てる。また、状態 <var>i</var> から状態 <var>j</var> への遷移確率を、パーセント単位の整数 <var>A_{i,j}</var> として設定する。これらはすべての <var>i</var> に対して次の条件を満たさなければならない：</p>
<p>\[
\sum_{j=0}^{M-1} A_{i,j} = 100
\]</p>
<p>このモデルは状態 <var>0</var> から開始し、長さ <var>L</var> の文字列を生成すると停止する。生成される文字列の 1 文字目には、初期状態 <var>0</var> に割り当てられた文字 <var>C_0</var> が使われる。その後は遷移確率に従って状態遷移を行い、各遷移先の状態に割り当てられた文字を順に出力していく。</p>
<p>このようにして生成された文字列において、各文字列 <var>S_i</var> が連続部分文字列として <strong>1 回以上</strong> 現れた場合、その好ましさ <var>P_i</var> を獲得する。好ましさの総和の期待値ができるだけ大きくなるように、文字割り当て <var>C_0, C_1, \dots, C_{M-1}</var> および遷移確率行列 <var>A</var> を設計せよ。</p>
</section>
</div>

<div class="part">
<section>
<h3>得点</h3><p>設計したモデルで長さ <var>L</var> の文字列を生成する場合に、各文字列 <var>S_i</var> が連続部分文字列として <strong>1回以上</strong> 含まれる確率を <var>Q_i</var> とする。
このとき、以下のスコアが得られる。</p>
<p>\[
\mathrm{round}\left(\sum_{i=0}^{N-1} P_i \cdot Q_i\right)
\]</p>
<p>合計で 150 個のテストケースがあり、各テストケースの得点の合計が提出の得点となる。
一つ以上のテストケースで不正な出力や制限時間超過をした場合、提出全体の判定が<span class='label label-warning' data-toggle='tooltip' data-placement='top' title="不正解">WA</span>や<span class='label label-warning' data-toggle='tooltip' data-placement='top' title="実行時間制限超過">TLE</span>となる。
コンテスト時間中に得た最高得点で最終順位が決定され、コンテスト終了後のシステムテストは行われない。 同じ得点を複数の参加者が得た場合、提出時刻に関わらず同じ順位となる。</p>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>入力</h3><p>入力は以下の形式で標準入力から与えられる。</p>
<pre><var>N</var> <var>M</var> <var>L</var>
<var>S_0</var> <var>P_0</var>
<var>S_1</var> <var>P_1</var>
<var>\vdots</var>
<var>S_{N-1}</var> <var>P_{N-1}</var>
</pre>
<ul>
<li><var>N</var> は文字列の数を表し、すべてのテストケースで <var>N = 36</var> に固定されている。</li>
<li><var>M</var> はモデルの状態数であり、<var>M = 12</var> に固定されている。</li>
<li><var>L</var> は生成する文字列の長さであり、<var>L = 10^6</var> に固定されている。</li>
<li><var>S_i</var> は <code>a</code>〜<code>f</code> の英小文字からなる長さ <var>6 \leq |S_i| \leq 12</var> の文字列である。</li>
<li>好ましさ <var>P_i</var> は正の整数であり、<var>1 \leq P_i \leq 17000</var> を満たす。</li>
<li>すべての <var>S_i</var> は互いに異なる。</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>出力</h3><p>設計したモデルにおいて、<var>i</var> 番目の状態に割り当てる文字を <var>C_i</var>、状態 <var>i</var> から状態 <var>j</var> への遷移確率を <var>A_{i,j}</var> としたとき、以下の形式で標準出力に出力せよ。</p>
<pre><var>C_0</var> <var>A_{0,0}</var> <var>\cdots</var> <var>A_{0,M-1}</var>
<var>\vdots</var>
<var>C_{M-1}</var> <var>A_{M-1,0}</var> <var>\cdots</var> <var>A_{M-1,M-1}</var>
</pre>
<ul>
<li>各 <var>C_i</var> は <code>a</code>〜<code>f</code> のいずれかである。</li>
<li>各 <var>A_{i,j}</var> は <var>0 \leq A_{i,j} \leq 100</var> を満たす整数で、すべての <var>i</var> に対して \(\sum_{j=0}^{M-1} A_{i,j} = 100\) を満たさなければならない。</li>
</ul>
<p>解は複数回出力しても良い。
複数出力された場合、一番最後に出力された解のみが採点に用いられる。
Web版のビジュアライザを用いると、複数の解の比較が可能である。</p>
<p><a href="https://img.atcoder.jp/ahc047/cHmFekjC.html?lang=ja&seed=0&output=sample">例を見る</a></p>
</section>
</div>

<div class="part">
<section>
<h3>入力生成方法</h3><p><var>\mathrm{rand}(L, U)</var>: <var>L</var> 以上 <var>U</var> 以下の整数値を一様ランダムに生成する。</p>
<h4>文字列 <var>S_i</var> の生成</h4>
<p>各 <var>S_i</var> の長さ <var>\ell_i</var> を <var>\ell_i = \mathrm{rand}(6, 12)</var> により決定し、長さ <var>\ell_i</var> の文字列を以下の手順で生成する：</p>
<ul>
<li>アルファベット <code>a</code>〜<code>f</code> から <var>\ell_i</var> 回ランダムに選んで連結する。</li>
<li>同じ文字が複数回現れてもよい。</li>
</ul>
<p>生成した文字列 <var>S_i</var> がすでに生成した文字列と一致した場合、長さ <var>\ell_i</var> の生成からやり直す。</p>
<h4>好ましさ <var>P_i</var> の生成</h4>
<p>各文字列 <var>S_i</var> に対して、以下により対応する好ましさ <var>P_i</var> を生成する：</p>
<ul>
<li>最大値 <var>U_i = \left\lfloor 1.5^{2 \cdot \ell_i} \right\rfloor</var> を計算する。</li>
<li><var>P_i = \mathrm{rand}(1, U_i)</var> により一様ランダムに生成する。</li>
</ul>
<p>このようにして、<var>N = 36</var> 個の <var>(S_i, P_i)</var> の組を独立に生成する。</p>
</section>
</div>

<div class="part">
<section>
<h3>ツール(入力ジェネレータ・ビジュアライザ)</h3><ul>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC.html?lang=ja">Web版</a>: ローカル版より高性能でアニメーション表示が可能です。</li>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC.zip">ローカル版</a>: 使用するには<a href="https://www.rust-lang.org/ja">Rust言語</a>のコンパイル環境をご用意下さい。<ul>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC_windows.zip">Windows用のコンパイル済みバイナリ</a>: Rust言語の環境構築が面倒な方は代わりにこちらをご利用下さい。</li>
</ul>
</li>
</ul>
<p>コンテスト期間中に、ビジュアライズ結果の共有や、解法・考察に関する言及は禁止されています。ご注意下さい。</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>入力例 1</h3><pre style="max-height:200px;overflow-y:scroll">36 12 1000000
acafbafdb 166
baeebdacd 86
baaffdcf 76
cfddcba 251
acdecbbfddaf 12423
ebcebe 107
feddecdb 373
acadbc 40
dcfaabebefcd 15639
fcebaade 438
cbefcedaaf 2468
efcfafcbcaac 4414
dbddcfa 96
cabacbdb 219
cbdeadcbad 3110
bbdeacbbe 894
deafadebdad 7067
dceedaacfefa 6453
deffecdee 280
cfffaaeca 651
aeffcbcfec 1021
ccefdcddadfd 6189
ffcdcb 91
afddebceadc 2283
ffebaff 258
aeceafebd 1235
fbbfec 83
fcdeceffbaf 1787
ddfffeb 188
bebffddaa 238
eedbfbaed 500
cacbccdbd 1346
cafbfbedcff 393
eccbdecdfefa 4423
fdfaddae 522
befebddfe 507
</pre>
</section>
</div>

<div class="part">
<section>
<h3>出力例 1</h3><pre style="max-height:200px;overflow-y:scroll">e 66 0 0 0 0 12 0 0 0 0 9 13
e 36 12 0 0 0 0 0 0 0 11 0 41
d 0 20 0 56 0 0 0 0 5 0 19 0
a 0 8 12 79 1 0 0 0 0 0 0 0
f 0 0 0 0 0 0 41 0 0 10 37 12
c 0 0 0 31 0 0 0 53 15 0 1 0
b 0 0 0 0 23 0 65 1 0 0 0 11
f 34 0 8 0 0 0 0 0 0 14 0 44
e 21 0 0 0 10 57 0 0 0 12 0 0
f 0 41 18 0 0 22 0 0 0 0 19 0
a 6 0 0 46 0 0 16 0 0 0 32 0
b 12 0 0 21 24 43 0 0 0 0 0 0
</pre></section>
</div>
</span>
<span class="lang-en">

<div class="part">
<section>
<h3>Problem Statement</h3><p>Takahashi has <var>N</var> favorite strings. The <var>i</var>-th string is denoted by <var>S_i</var>, and its preference is <var>P_i</var>. Each <var>S_i</var> consists only of lowercase English letters from <code>a</code> to <code>f</code>.</p>
<p>Recently, Takahashi has become interested in probabilistic models for generating strings. He wants to design a generation model, called the <strong>Lovely Language Model (LLM)</strong>, that generates the strings he likes with high probability.</p>
<p>This model consists of <var>M</var> states. Assign a single lowercase letter <var>C_i</var> from <code>a</code> to <code>f</code> to each state <var>i</var> (<var>0 \leq i &lt; M</var>). Additionally, for each pair of states <var>(i, j)</var>, define the transition probability from state <var>i</var> to state <var>j</var> as an integer <var>A_{i,j}</var>, which represents a percentage value. These values must satisfy the following condition for all <var>i</var>:</p>
<p>\[
\sum_{j=0}^{M-1} A_{i,j} = 100
\]</p>
<p>The model starts from state <var>0</var> and stops after generating a string of length <var>L</var>. The first character of the generated string is the character assigned to state <var>0</var>, namely <var>C_0</var>. Then, the model performs state transitions according to the transition probabilities, outputting the character assigned to each newly transitioned state in order.</p>
<p>For each string <var>S_i</var>, if it appears <strong>at least once</strong> as a contiguous substring in the generated string, Takahashi gains its corresponding preference <var>P_i</var>. Your task is to design the character assignment <var>C_0, C_1, \dots, C_{M-1}</var> and transition matrix <var>A</var> to maximize the expected total preference.</p>
</section>
</div>

<div class="part">
<section>
<h3>Scoring</h3><p>Let <var>Q_i</var> be the probability that the generated string of length <var>L</var> contains the string <var>S_i</var> <strong>at least once</strong> as a contiguous substring.</p>
<p>Then, your score is calculated as follows:</p>
<p>\[
\mathrm{round}\left(\sum_{i=0}^{N-1} P_i \cdot Q_i\right)
\]</p>
<p>There are <var>150</var> test cases, and the score of a submission is the total score for each test case.
If your submission produces an illegal output or exceeds the time limit for some test cases, the submission itself will be judged as <span class='label label-warning' data-toggle='tooltip' data-placement='top' title="Wrong Answer">WA</span> or <span class='label label-warning' data-toggle='tooltip' data-placement='top' title="Time Limit Exceeded">TLE</span> , and the score of the submission will be zero.
The highest score obtained during the contest will determine the final ranking, and there will be no system test after the contest.
If more than one participant gets the same score, they will be ranked in the same place regardless of the submission time.</p>
</section>
</div>

<hr />
<div class="io-style">
<div class="part">
<section>
<h3>Input</h3><p>Input is given from Standard Input in the following format:</p>
<pre><var>N</var> <var>M</var> <var>L</var>
<var>S_0</var> <var>P_0</var>
<var>S_1</var> <var>P_1</var>
<var>\vdots</var>
<var>S_{N-1}</var> <var>P_{N-1}</var>
</pre>
<ul>
<li><var>N</var> is the number of strings. It is fixed at <var>N = 36</var> in all test cases.</li>
<li><var>M</var> is the number of states in the model. It is fixed at <var>M = 12</var>.</li>
<li><var>L</var> is the length of the string to be generated. It is fixed at <var>L = 10^6</var>.</li>
<li>Each <var>S_i</var> is a string consisting of lowercase English letters from <code>a</code> to <code>f</code>, with length satisfying <var>6 \leq |S_i| \leq 12</var>.</li>
<li>Each preference <var>P_i</var> is a positive integer satisfying <var>1 \leq P_i \leq 17000</var>.</li>
<li>All <var>S_i</var> are distinct.</li>
</ul>
</section>
</div>

<div class="part">
<section>
<h3>Output</h3><p>In the designed model, let <var>C_i</var> be the character assigned to state <var>i</var>, and <var>A_{i,j}</var> be the transition probability from state <var>i</var> to state <var>j</var>.</p>
<p>Then, output to Standard Output in the following format:</p>
<pre><var>C_0</var> <var>A_{0,0}</var> <var>\cdots</var> <var>A_{0,M-1}</var>
<var>\vdots</var>
<var>C_{M-1}</var> <var>A_{M-1,0}</var> <var>\cdots</var> <var>A_{M-1,M-1}</var>
</pre>
<ul>
<li>Each <var>C_i</var> must be one of the lowercase letters from <code>a</code> to <code>f</code>.</li>
<li>Each <var>A_{i,j}</var> must be an integer satisfying <var>0 \leq A_{i,j} \leq 100</var>, and for every <var>i</var>, the following condition must hold:</li>
</ul>
<p>\[
\sum_{j=0}^{M-1} A_{i,j} = 100
\]</p>
<p>Your program may output multiple solutions.
If multiple solutions are output, only the last one is used for scoring.
You can compare multiple solutions using the web version of the visualizer.</p>
<p><a href="https://img.atcoder.jp/ahc047/cHmFekjC.html?lang=en&seed=0&output=sample">Show example</a></p>
</section>
</div>

<div class="part">
<section>
<h3>Input Generation</h3><p><var>\mathrm{rand}(L, U)</var>: Generates a uniformly random integer between <var>L</var> and <var>U</var>, inclusive.</p>
<h4>Generation of Strings <var>S_i</var></h4>
<p>For each <var>S_i</var>, determine its length <var>\ell_i</var> using <var>\ell_i = \mathrm{rand}(6, 12)</var>, then generate a string of length <var>\ell_i</var> as follows:</p>
<ul>
<li>Randomly select <var>\ell_i</var> characters from the letters <code>a</code> to <code>f</code> and concatenate them.</li>
<li>The same character may appear multiple times.</li>
</ul>
<p>If the generated string <var>S_i</var> is identical to any previously generated string, restart the generation from the length selection step.</p>
<h4>Generation of Preferences <var>P_i</var></h4>
<p>For each string <var>S_i</var>, generate its corresponding preference <var>P_i</var> as follows:</p>
<ul>
<li>Compute the upper bound <var>U_i = \left\lfloor 1.5^{2 \cdot \ell_i} \right\rfloor</var>.</li>
<li>Generate <var>P_i = \mathrm{rand}(1, U_i)</var> uniformly at random.</li>
</ul>
<p>Repeat this process independently to generate <var>N = 36</var> pairs of <var>(S_i, P_i)</var>.</p>
</section>
</div>

<div class="part">
<section>
<h3>Tools (Input generator and visualizer)</h3><ul>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC.html?lang=en">Web version</a>: This is more powerful than the local version providing animations.</li>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC.zip">Local version</a>: You need a compilation environment of <a href="https://www.rust-lang.org/">Rust language</a>.<ul>
<li><a href="https://img.atcoder.jp/ahc047/cHmFekjC_windows.zip">Pre-compiled binary for Windows</a>: If you are not familiar with the Rust language environment, please use this instead.</li>
</ul>
</li>
</ul>
<p>Please be aware that sharing visualization results or discussing solutions/ideas during the contest is prohibited.</p>
</section>
</div>
</div>

<hr />
<div class="part">
<section>
<h3>Sample Input 1</h3><pre style="max-height:200px;overflow-y:scroll">36 12 1000000
acafbafdb 166
baeebdacd 86
baaffdcf 76
cfddcba 251
acdecbbfddaf 12423
ebcebe 107
feddecdb 373
acadbc 40
dcfaabebefcd 15639
fcebaade 438
cbefcedaaf 2468
efcfafcbcaac 4414
dbddcfa 96
cabacbdb 219
cbdeadcbad 3110
bbdeacbbe 894
deafadebdad 7067
dceedaacfefa 6453
deffecdee 280
cfffaaeca 651
aeffcbcfec 1021
ccefdcddadfd 6189
ffcdcb 91
afddebceadc 2283
ffebaff 258
aeceafebd 1235
fbbfec 83
fcdeceffbaf 1787
ddfffeb 188
bebffddaa 238
eedbfbaed 500
cacbccdbd 1346
cafbfbedcff 393
eccbdecdfefa 4423
fdfaddae 522
befebddfe 507
</pre>
</section>
</div>

<div class="part">
<section>
<h3>Sample Output 1</h3><pre style="max-height:200px;overflow-y:scroll">e 66 0 0 0 0 12 0 0 0 0 9 13
e 36 12 0 0 0 0 0 0 0 11 0 41
d 0 20 0 56 0 0 0 0 5 0 19 0
a 0 8 12 79 1 0 0 0 0 0 0 0
f 0 0 0 0 0 0 41 0 0 10 37 12
c 0 0 0 31 0 0 0 53 15 0 1 0
b 0 0 0 0 23 0 65 1 0 0 0 11
f 34 0 8 0 0 0 0 0 0 14 0 44
e 21 0 0 0 10 57 0 0 0 12 0 0
f 0 41 18 0 0 22 0 0 0 0 19 0
a 6 0 0 46 0 0 16 0 0 0 32 0
b 12 0 0 21 24 43 0 0 0 0 0 0
</pre></section>
</div>
</span>
</span>

		</div>

		

		
		<hr/>
		<form class="form-horizontal form-code-submit" action="/contests/ahc047/submit" method="POST">
			<input type="hidden" name="data.TaskScreenName" value="ahc047_a" />
			
			<div class="form-group ">
				<label class="control-label col-sm-3 col-md-2" for="select-lang">言語</label>
				<div id="select-lang" class="col-sm-5" data-name="data.LanguageId">
					<select class="form-control current" data-placeholder="-" name="data.LanguageId" required>
						<option></option>
						
							<option value="5001" data-ace-mode="c_cpp">C&#43;&#43; 20 (gcc 12.2)</option>
						
							<option value="5002" data-ace-mode="golang">Go (go 1.20.6)</option>
						
							<option value="5003" data-ace-mode="csharp">C# 11.0 (.NET 7.0.7)</option>
						
							<option value="5004" data-ace-mode="kotlin">Kotlin (Kotlin/JVM 1.8.20)</option>
						
							<option value="5005" data-ace-mode="java">Java (OpenJDK 17)</option>
						
							<option value="5006" data-ace-mode="nim">Nim (Nim 1.6.14)</option>
						
							<option value="5007" data-ace-mode="text">V (V 0.4)</option>
						
							<option value="5008" data-ace-mode="text">Zig (Zig 0.10.1)</option>
						
							<option value="5009" data-ace-mode="javascript">JavaScript (Node.js 18.16.1)</option>
						
							<option value="5010" data-ace-mode="javascript">JavaScript (Deno 1.35.1)</option>
						
							<option value="5011" data-ace-mode="r">R (GNU R 4.2.1)</option>
						
							<option value="5012" data-ace-mode="d">D (DMD 2.104.0)</option>
						
							<option value="5013" data-ace-mode="d">D (LDC 1.32.2)</option>
						
							<option value="5014" data-ace-mode="swift">Swift (swift 5.8.1)</option>
						
							<option value="5015" data-ace-mode="dart">Dart (Dart 3.0.5)</option>
						
							<option value="5016" data-ace-mode="php">PHP (php 8.2.8)</option>
						
							<option value="5017" data-ace-mode="c_cpp">C (gcc 12.2.0)</option>
						
							<option value="5018" data-ace-mode="ruby">Ruby (ruby 3.2.2)</option>
						
							<option value="5019" data-ace-mode="crystal">Crystal (Crystal 1.9.1)</option>
						
							<option value="5020" data-ace-mode="text">Brainfuck (bf 20041219)</option>
						
							<option value="5021" data-ace-mode="fsharp">F# 7.0 (.NET 7.0.7)</option>
						
							<option value="5022" data-ace-mode="julia">Julia (Julia 1.9.2)</option>
						
							<option value="5023" data-ace-mode="sh">Bash (bash 5.2.2)</option>
						
							<option value="5024" data-ace-mode="text">Text (cat 8.32)</option>
						
							<option value="5025" data-ace-mode="haskell">Haskell (GHC 9.4.5)</option>
						
							<option value="5026" data-ace-mode="fortran">Fortran (gfortran 12.2)</option>
						
							<option value="5027" data-ace-mode="lua">Lua (LuaJIT 2.1.0-beta3)</option>
						
							<option value="5028" data-ace-mode="c_cpp">C&#43;&#43; 23 (gcc 12.2)</option>
						
							<option value="5029" data-ace-mode="lisp">Common Lisp (SBCL 2.3.6)</option>
						
							<option value="5030" data-ace-mode="cobol">COBOL (Free) (GnuCOBOL 3.1.2)</option>
						
							<option value="5031" data-ace-mode="c_cpp">C&#43;&#43; 23 (Clang 16.0.6)</option>
						
							<option value="5032" data-ace-mode="sh">Zsh (Zsh 5.9)</option>
						
							<option value="5033" data-ace-mode="python">SageMath (SageMath 9.5)</option>
						
							<option value="5034" data-ace-mode="sh">Sed (GNU sed 4.8)</option>
						
							<option value="5035" data-ace-mode="text">bc (bc 1.07.1)</option>
						
							<option value="5036" data-ace-mode="text">dc (dc 1.07.1)</option>
						
							<option value="5037" data-ace-mode="perl">Perl (perl  5.34)</option>
						
							<option value="5038" data-ace-mode="sh">AWK (GNU Awk 5.0.1)</option>
						
							<option value="5039" data-ace-mode="text">なでしこ (cnako3 3.4.20)</option>
						
							<option value="5040" data-ace-mode="text">Assembly x64 (NASM 2.15.05)</option>
						
							<option value="5041" data-ace-mode="pascal">Pascal (fpc 3.2.2)</option>
						
							<option value="5042" data-ace-mode="csharp">C# 11.0 AOT (.NET 7.0.7)</option>
						
							<option value="5043" data-ace-mode="lua">Lua (Lua 5.4.6)</option>
						
							<option value="5044" data-ace-mode="prolog">Prolog (SWI-Prolog 9.0.4)</option>
						
							<option value="5045" data-ace-mode="sh">PowerShell (PowerShell 7.3.1)</option>
						
							<option value="5046" data-ace-mode="scheme">Scheme (Gauche 0.9.12)</option>
						
							<option value="5047" data-ace-mode="scala">Scala 3.3.0 (Scala Native 0.4.14)</option>
						
							<option value="5048" data-ace-mode="vbscript">Visual Basic 16.9 (.NET 7.0.7)</option>
						
							<option value="5049" data-ace-mode="text">Forth (gforth 0.7.3)</option>
						
							<option value="5050" data-ace-mode="clojure">Clojure (babashka 1.3.181)</option>
						
							<option value="5051" data-ace-mode="erlang">Erlang (Erlang 26.0.2)</option>
						
							<option value="5052" data-ace-mode="typescript">TypeScript 5.1 (Deno 1.35.1)</option>
						
							<option value="5053" data-ace-mode="c_cpp">C&#43;&#43; 17 (gcc 12.2)</option>
						
							<option value="5054" data-ace-mode="rust">Rust (rustc 1.70.0)</option>
						
							<option value="5055" data-ace-mode="python">Python (CPython 3.11.4)</option>
						
							<option value="5056" data-ace-mode="scala">Scala (Dotty 3.3.0)</option>
						
							<option value="5057" data-ace-mode="text">Koka (koka 2.4.0)</option>
						
							<option value="5058" data-ace-mode="typescript">TypeScript 5.1 (Node.js 18.16.1)</option>
						
							<option value="5059" data-ace-mode="ocaml">OCaml (ocamlopt 5.0.0)</option>
						
							<option value="5060" data-ace-mode="raku">Raku (Rakudo 2023.06)</option>
						
							<option value="5061" data-ace-mode="text">Vim (vim 9.0.0242)</option>
						
							<option value="5062" data-ace-mode="lisp">Emacs Lisp (Native Compile) (GNU Emacs 28.2)</option>
						
							<option value="5063" data-ace-mode="python">Python (Mambaforge / CPython 3.10.10)</option>
						
							<option value="5064" data-ace-mode="clojure">Clojure (clojure 1.11.1)</option>
						
							<option value="5065" data-ace-mode="text">プロデル (mono版プロデル 1.9.1182)</option>
						
							<option value="5066" data-ace-mode="text">ECLiPSe (ECLiPSe 7.1_13)</option>
						
							<option value="5067" data-ace-mode="text">Nibbles (literate form) (nibbles 1.01)</option>
						
							<option value="5068" data-ace-mode="ada">Ada (GNAT 12.2)</option>
						
							<option value="5069" data-ace-mode="text">jq (jq 1.6)</option>
						
							<option value="5070" data-ace-mode="text">Cyber (Cyber v0.2-Latest)</option>
						
							<option value="5071" data-ace-mode="clojure">Carp (Carp 0.5.5)</option>
						
							<option value="5072" data-ace-mode="c_cpp">C&#43;&#43; 17 (Clang 16.0.6)</option>
						
							<option value="5073" data-ace-mode="c_cpp">C&#43;&#43; 20 (Clang 16.0.6)</option>
						
							<option value="5074" data-ace-mode="text">LLVM IR (Clang 16.0.6)</option>
						
							<option value="5075" data-ace-mode="lisp">Emacs Lisp (Byte Compile) (GNU Emacs 28.2)</option>
						
							<option value="5076" data-ace-mode="text">Factor (Factor 0.98)</option>
						
							<option value="5077" data-ace-mode="d">D (GDC 12.2)</option>
						
							<option value="5078" data-ace-mode="python">Python (PyPy 3.10-v7.3.12)</option>
						
							<option value="5079" data-ace-mode="text">Whitespace (whitespacers 1.0.0)</option>
						
							<option value="5080" data-ace-mode="text">&gt;&lt;&gt; (fishr 0.1.0)</option>
						
							<option value="5081" data-ace-mode="ocaml">ReasonML (reason 3.9.0)</option>
						
							<option value="5082" data-ace-mode="python">Python (Cython 0.29.34)</option>
						
							<option value="5083" data-ace-mode="matlab">Octave (GNU Octave 8.2.0)</option>
						
							<option value="5084" data-ace-mode="haxe">Haxe (JVM) (Haxe 4.3.1)</option>
						
							<option value="5085" data-ace-mode="elixir">Elixir (Elixir 1.15.2)</option>
						
							<option value="5086" data-ace-mode="text">Mercury (Mercury 22.01.6)</option>
						
							<option value="5087" data-ace-mode="text">Seed7 (Seed7 3.2.1)</option>
						
							<option value="5088" data-ace-mode="lisp">Emacs Lisp (No Compile) (GNU Emacs 28.2)</option>
						
							<option value="5089" data-ace-mode="text">Unison (Unison M5b)</option>
						
							<option value="5090" data-ace-mode="cobol">COBOL (GnuCOBOL(Fixed) 3.1.2)</option>
						
					</select>
					<span class="error"></span>
				</div>
			</div>
			<script>var currentLang = getLS('defaultLang');</script>
			
			
<div class="form-group">
	<div class="col-sm-3 col-md-2 editor-label">
		<label class="control-label" for="sourceCode">ソースコード</label>
		<div class="editor-buttons">
			<button id="btn-open-file" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-folder-open" aria-hidden="true"></span> &nbsp; ファイルを開く
			</button>
			<button id="btn-customize" type="button" class="btn btn-default btn-sm">
				<span class="glyphicon glyphicon-cog" aria-hidden="true"></span> &nbsp; カスタマイズ
			</button>
			<button type="button" class="btn btn-default btn-sm btn-toggle-editor" data-toggle="button" autocomplete="off">
				エディタ切り替え
			</button>
			<button type="button" class="btn btn-default btn-sm btn-auto-height" data-toggle="button" autocomplete="off">
				高さ自動調節
			</button>
		</div>
	</div>
	<div class="col-sm-9 col-md-10" id="sourceCode">
		<div id="editor"></div>
		<textarea id="plain-textarea" class="form-control" style="display:none;" name="sourceCode"></textarea>
		<p>
			<span class="gray">※ 512 KiB まで</span><br>
			<span class="gray">※ ソースコードは「Main.<i>拡張子</i>」で保存されます</span>
		</p>
	</div>
	<input id="input-open-file" type="file" style="display:none;">
</div>


			<input type="hidden" name="csrf_token" value="UJ3O&#43;CKvGxMvJezEGZGXD22Xe6c7pPUFuOPjMKcTrVs=" />
			<div class="form-group">
				<label class="control-label col-sm-3 col-md-2"></label>
				<div class="col-sm-5">
					
					<button type="submit" class="btn btn-primary" id="submit">提出</button>
				</div>
			</div>
		</form>
		
	</div>
</div>




		
			<hr>
			
			
			
<div class="a2a_kit a2a_kit_size_20 a2a_default_style pull-right" data-a2a-url="https://atcoder.jp/contests/ahc047/tasks/ahc047_a?lang=ja" data-a2a-title="A - Lovely Language Model">
	<a class="a2a_button_facebook"></a>
	<a class="a2a_button_twitter"></a>
	
		<a class="a2a_button_hatena"></a>
	
	<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
</div>

		
		<script async src="//static.addtoany.com/menu/page.js"></script>
		
	</div> 
	<hr>
</div> 

	<div class="container" style="margin-bottom: 80px;">
			<footer class="footer">
			
				<ul>
					<li><a href="/contests/ahc047/rules">ルール</a></li>
					<li><a href="/contests/ahc047/glossary">用語集</a></li>
					
				</ul>
			
			<ul>
				<li><a href="/tos">利用規約</a></li>
				<li><a href="/privacy">プライバシーポリシー</a></li>
				<li><a href="/personal">個人情報保護方針</a></li>
				<li><a href="/company">企業情報</a></li>
				<li><a href="/faq">よくある質問</a></li>
				<li><a href="/contact">お問い合わせ</a></li>
				<li><a href="/documents/request">資料請求</a></li>
			</ul>
			<div class="text-center">
					<small id="copyright">Copyright Since 2012 &copy;<a href="http://atcoder.co.jp">AtCoder Inc.</a> All rights reserved.</small>
			</div>
			</footer>
	</div>
	<p id="fixed-server-timer" class="contest-timer"></p>
	<div id="scroll-page-top" style="display:none;"><span class="glyphicon glyphicon-arrow-up" aria-hidden="true"></span> ページトップ</div>

</body>
</html>


